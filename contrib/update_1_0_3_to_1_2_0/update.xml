<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<?xml-stylesheet type="text/xsl" href="modx.prosilver.en.xsl"?>
<!--For security purposes, please check: http://www.phpbb.com/mods/ for the latest version of this MOD. Although MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD. No support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/-->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.2.1.xsd">
  <header>
    <license>http://opensource.org/licenses/gpl-license.php GNU General Public License v2</license>
    <title lang="de">NV Exif Daten</title>
    <title lang="en-gb">NV Exif Data</title>
    <description lang="de"><![CDATA[Zeigt die Exif-Daten der Bilder an, wenn sie als Datei-Anhang hocgeladen wurden.]]></description>
    <description lang="en-gb"><![CDATA[Shows the Exif-Data on images, which were uploaded as attachments.]]></description>
    <author-notes lang="de"><![CDATA[Die exif-Erweiterung muss installiert sein, damit die MOD funktioniert.]]></author-notes>
    <author-notes lang="en-gb"><![CDATA[The exif-Extension must be installed on your server to use this MOD.]]></author-notes>
    <author-group>
      <author>
        <realname>Joas Schilling</realname>
        <email>nickvergessen@gmx.de</email>
        <username>nickvergessen</username>
        <homepage>http://www.flying-bits.org/</homepage>
        <contributions />
      </author>
    </author-group>
    <mod-version>1.2.0</mod-version>
    <installation>
      <level>easy</level>
      <time>120</time>
      <target-version>3.0.4</target-version>
    </installation>
    <link-group>
      <link type="parent" lang="de" href="../../install.xml">Installations-Anleitung</link>
      <link type="parent" lang="en-gb" href="../../install.xml">Install</link>
      <link type="language" lang="de" href="contrib/de.xml">Anleitung für das deutsche Sprachpaket</link>
      <link type="language" lang="en-gb" href="contrib/de.xml">Manual for German Language-set</link>
      <link type="template" lang="de" href="contrib/subsilver2.xml">Anleitung für das Style subsilver2</link>
      <link type="template" lang="en-gb" href="contrib/subsilver2.xml">Manual for subsilver2 Style</link>
    </link-group>
    <meta name="generator" content="Phpbb.ModTeam.Tools (c#)" />
  </header>
  <action-group>
    <open src="includes/functions_content.php">
      <edit>
        <find><![CDATA[					$exif = ($attachment['extension'] == 'jpg' || $attachment['extension'] == 'jpeg') ? @exif_read_data($filename, 0, true) : array();
					if (!empty($exif["EXIF"]))
					{
						$exif_date = $exif_focal = $exif_exposureprogram = $exif_exposure_bias = $exif_metering_mode = 
						$exif_aperture = $exif_exposure = $exif_iso = $exif_whitebalance = $exif_flash = $exif_make = $exif_model = $user->lang['EXIF_NOT_AVAILABLE'];

						if(isset($exif["EXIF"]["DateTimeOriginal"]))
						{
							$timestamp_year = substr($exif["EXIF"]["DateTimeOriginal"], 0, 4);
							$timestamp_month = substr($exif["EXIF"]["DateTimeOriginal"], 5, 2);
							$timestamp_day = substr($exif["EXIF"]["DateTimeOriginal"], 8, 2);
							$timestamp_hour = substr($exif["EXIF"]["DateTimeOriginal"], 11, 2);
							$timestamp_minute = substr($exif["EXIF"]["DateTimeOriginal"], 14, 2);
							$timestamp_second = substr($exif["EXIF"]["DateTimeOriginal"], 17, 2);
							$timestamp = mktime($timestamp_hour, $timestamp_minute, $timestamp_second, $timestamp_month, $timestamp_day, $timestamp_year);
							$exif_date = $user->format_date($timestamp);
						}
						if(isset($exif["EXIF"]["FocalLength"]))
						{
							list($num, $den) = explode("/", $exif["EXIF"]["FocalLength"]);
							$exif_focal  = ($num/$den);
						}
						if(isset($exif["EXIF"]["ExposureTime"]))
						{
							list($num, $den) = explode("/", $exif["EXIF"]["ExposureTime"]);
							if ($num > $den) { $exif_exposure = $num/$den; } else { $exif_exposure = ' 1/' . $den/$num ; }
						}
						if(isset($exif["EXIF"]["FNumber"]))
						{
							list($num,$den) = explode("/",$exif["EXIF"]["FNumber"]);
							$exif_aperture  = "F/" . ($num/$den);
						}
						if(isset($exif["EXIF"]["ISOSpeedRatings"]))
						{
							$exif_iso = $exif["EXIF"]["ISOSpeedRatings"];
						}
						if (isset($exif["EXIF"]["WhiteBalance"]))
						{
							$exif_whitebalance = $user->lang['EXIF_WHITEB_' . (($exif["EXIF"]["WhiteBalance"]) ? 'MANU' : 'AUTO')];
						}
						if(isset($exif["EXIF"]["Flash"]))
						{
							$exif_flash = $user->lang['EXIF_FLASH_CASE_' . $exif["EXIF"]["Flash"]];
						}
						if (isset($exif["IFD0"]["Model"]))
						{
							$exif_model = ucwords($exif["IFD0"]["Model"]);
						}
						if (isset($exif["EXIF"]["ExposureProgram"]))
						{
							$exif_exposureprogram = $user->lang['EXIF_EXPOSURE_PROG_' . $exif["EXIF"]["ExposureProgram"]];
						}
						if (isset($exif["EXIF"]["ExposureBiasValue"]))
						{
							list($num,$den) = explode("/",$exif["EXIF"]["ExposureBiasValue"]);
							if (($num/$den) == 0) { $exif_exposure_bias = 0; }
							$exif_exposure_bias = sprintf($user->lang['EXIF_EXPOSURE_BIAS_EXP'], $exif_exposure_bias);
						}
						if (isset($exif["EXIF"]["MeteringMode"]))
						{
							$exif_metering_mode = $user->lang['EXIF_METERING_MODE_' . $exif["EXIF"]["MeteringMode"]];
						}

						$block_array += array(
							'EXIF_DATE'			=> htmlspecialchars($exif_date),
							'EXIF_FOCAL'		=> htmlspecialchars($exif_focal),
							'EXIF_EXPOSURE'		=> htmlspecialchars($exif_exposure),
							'EXIF_APERTURE'		=> htmlspecialchars($exif_aperture),
							'EXIF_ISO'			=> htmlspecialchars($exif_iso),
							'EXIF_FLASH'		=> htmlspecialchars($exif_flash),
							'EXIF_EXPOSURE_PROG'	=> htmlspecialchars($exif_exposureprogram),
							'EXIF_EXPOSURE_BIAS'	=> htmlspecialchars($exif_exposure_bias),
							'EXIF_METERING_MODE'	=> htmlspecialchars($exif_metering_mode),

							'WHITEB'		=> htmlspecialchars($exif_whitebalance),
							'CAM_MODEL'		=> htmlspecialchars($exif_model),
							'S_EXIF_DATA'	=> true,
						);
					}]]></find>
        <action type="replace-with"><![CDATA[					$exif = ($attachment['extension'] == 'jpg' || $attachment['extension'] == 'jpeg') ? @exif_read_data($filename, 0, true) : array();
					$exif_data = array();
					if (!empty($exif["EXIF"]))
					{
						if(isset($exif["EXIF"]["DateTimeOriginal"]))
						{
							$timestamp_year = substr($exif["EXIF"]["DateTimeOriginal"], 0, 4);
							$timestamp_month = substr($exif["EXIF"]["DateTimeOriginal"], 5, 2);
							$timestamp_day = substr($exif["EXIF"]["DateTimeOriginal"], 8, 2);
							$timestamp_hour = substr($exif["EXIF"]["DateTimeOriginal"], 11, 2);
							$timestamp_minute = substr($exif["EXIF"]["DateTimeOriginal"], 14, 2);
							$timestamp_second = substr($exif["EXIF"]["DateTimeOriginal"], 17, 2);
							$timestamp = mktime($timestamp_hour, $timestamp_minute, $timestamp_second, $timestamp_month, $timestamp_day, $timestamp_year);
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_DATE'], 'EXIF_VALUE' => $user->format_date($timestamp));
						}
						if(isset($exif["EXIF"]["FocalLength"]))
						{
							list($num, $den) = explode("/", $exif["EXIF"]["FocalLength"]);
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_FOCAL'], 'EXIF_VALUE' => sprintf($user->lang['EXIF_FOCAL_EXP'], ($num/$den)));
						}
						if(isset($exif["EXIF"]["ExposureTime"]))
						{
							list($num, $den) = explode("/", $exif["EXIF"]["ExposureTime"]);
							if ($num > $den) { $exif_exposure = $num/$den; } else { $exif_exposure = ' 1/' . $den/$num ; }
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_EXPOSURE'], 'EXIF_VALUE' => sprintf($user->lang['EXIF_EXPOSURE_EXP'], $exif_exposure));
						}
						if(isset($exif["EXIF"]["FNumber"]))
						{
							list($num,$den) = explode("/", $exif["EXIF"]["FNumber"]);
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_APERTURE'], 'EXIF_VALUE' => "F/" . ($num/$den));
						}
						if(isset($exif["EXIF"]["ISOSpeedRatings"]))
						{
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_ISO'], 'EXIF_VALUE' => htmlspecialchars($exif["EXIF"]["ISOSpeedRatings"]));
						}
						if (isset($exif["EXIF"]["WhiteBalance"]))
						{
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_WHITEB'], 'EXIF_VALUE' => $user->lang['EXIF_WHITEB_' . (($exif["EXIF"]["WhiteBalance"]) ? 'MANU' : 'AUTO')]);
						}
						if(isset($exif["EXIF"]["Flash"]))
						{
							if (isset($user->lang['EXIF_FLASH_CASE_' . $exif["EXIF"]["Flash"]]))
							{
								$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_FLASH'], 'EXIF_VALUE' => $user->lang['EXIF_FLASH_CASE_' . $exif["EXIF"]["Flash"]]);
							}
						}
						if (isset($exif["IFD0"]["Model"]))
						{
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_CAM_MODEL'], 'EXIF_VALUE' => htmlspecialchars(ucwords($exif["IFD0"]["Model"])));
						}
						if (isset($exif["EXIF"]["ExposureProgram"]))
						{
							if (isset($user->lang['EXIF_EXPOSURE_PROG_' . $exif["EXIF"]["ExposureProgram"]]))
							{
								$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_EXPOSURE_PROG'], 'EXIF_VALUE' => $user->lang['EXIF_EXPOSURE_PROG_' . $exif["EXIF"]["ExposureProgram"]]);
							}
						}
						if (isset($exif["EXIF"]["ExposureBiasValue"]))
						{
							list($num,$den) = explode("/",$exif["EXIF"]["ExposureBiasValue"]);
							if (($num/$den) == 0) { $exif_exposure_bias = 0; } else { $exif_exposure_bias = $exif["EXIF"]["ExposureBiasValue"]; }
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_EXPOSURE_BIAS'], 'EXIF_VALUE' => htmlspecialchars(sprintf($user->lang['EXIF_EXPOSURE_BIAS_EXP'], $exif_exposure_bias)));
						}
						if (isset($exif["EXIF"]["MeteringMode"]))
						{
							if (isset($user->lang['EXIF_METERING_MODE_' . $exif["EXIF"]["MeteringMode"]]))
							{
								$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_METERING_MODE'], 'EXIF_VALUE' => $user->lang['EXIF_METERING_MODE_' . $exif["EXIF"]["MeteringMode"]]);
							}
						}
						$block_array += array(
							'_exifs'			=> $exif_data,
							'S_HAS_EXIF'		=> (!empty($exif_data)) ? true : false,
						);
					}]]></action>
      </edit>
      <edit>
        <find><![CDATA[					$exif = ($attachment['extension'] == 'jpg' || $attachment['extension'] == 'jpeg') ? @exif_read_data($filename, 0, true) : array();
					if (!empty($exif["EXIF"]))
					{
						$exif_date = $exif_focal = $exif_exposureprogram = $exif_exposure_bias = $exif_metering_mode = 
						$exif_aperture = $exif_exposure = $exif_iso = $exif_whitebalance = $exif_flash = $exif_make = $exif_model = $user->lang['EXIF_NOT_AVAILABLE'];

						if(isset($exif["EXIF"]["DateTimeOriginal"]))
						{
							$timestamp_year = substr($exif["EXIF"]["DateTimeOriginal"], 0, 4);
							$timestamp_month = substr($exif["EXIF"]["DateTimeOriginal"], 5, 2);
							$timestamp_day = substr($exif["EXIF"]["DateTimeOriginal"], 8, 2);
							$timestamp_hour = substr($exif["EXIF"]["DateTimeOriginal"], 11, 2);
							$timestamp_minute = substr($exif["EXIF"]["DateTimeOriginal"], 14, 2);
							$timestamp_second = substr($exif["EXIF"]["DateTimeOriginal"], 17, 2);
							$timestamp = mktime($timestamp_hour, $timestamp_minute, $timestamp_second, $timestamp_month, $timestamp_day, $timestamp_year);
							$exif_date = $user->format_date($timestamp);
						}
						if(isset($exif["EXIF"]["FocalLength"]))
						{
							list($num, $den) = explode("/", $exif["EXIF"]["FocalLength"]);
							$exif_focal  = ($num/$den);
						}
						if(isset($exif["EXIF"]["ExposureTime"]))
						{
							list($num, $den) = explode("/", $exif["EXIF"]["ExposureTime"]);
							if ($num > $den) { $exif_exposure = $num/$den; } else { $exif_exposure = ' 1/' . $den/$num ; }
						}
						if(isset($exif["EXIF"]["FNumber"]))
						{
							list($num,$den) = explode("/",$exif["EXIF"]["FNumber"]);
							$exif_aperture  = "F/" . ($num/$den);
						}
						if(isset($exif["EXIF"]["ISOSpeedRatings"]))
						{
							$exif_iso = $exif["EXIF"]["ISOSpeedRatings"];
						}
						if (isset($exif["EXIF"]["WhiteBalance"]))
						{
							$exif_whitebalance = $user->lang['EXIF_WHITEB_' . (($exif["EXIF"]["WhiteBalance"]) ? 'MANU' : 'AUTO')];
						}
						if(isset($exif["EXIF"]["Flash"]))
						{
							$exif_flash = $user->lang['EXIF_FLASH_CASE_' . $exif["EXIF"]["Flash"]];
						}
						if (isset($exif["IFD0"]["Model"]))
						{
							$exif_model = ucwords($exif["IFD0"]["Model"]);
						}
						if (isset($exif["EXIF"]["ExposureProgram"]))
						{
							$exif_exposureprogram = $user->lang['EXIF_EXPOSURE_PROG_' . $exif["EXIF"]["ExposureProgram"]];
						}
						if (isset($exif["EXIF"]["ExposureBiasValue"]))
						{
							list($num,$den) = explode("/",$exif["EXIF"]["ExposureBiasValue"]);
							if (($num/$den) == 0) { $exif_exposure_bias = 0; }
							$exif_exposure_bias = sprintf($user->lang['EXIF_EXPOSURE_BIAS_EXP'], $exif_exposure_bias);
						}
						if (isset($exif["EXIF"]["MeteringMode"]))
						{
							$exif_metering_mode = $user->lang['EXIF_METERING_MODE_' . $exif["EXIF"]["MeteringMode"]];
						}

						$block_array += array(
							'EXIF_DATE'			=> htmlspecialchars($exif_date),
							'EXIF_FOCAL'		=> htmlspecialchars($exif_focal),
							'EXIF_EXPOSURE'		=> htmlspecialchars($exif_exposure),
							'EXIF_APERTURE'		=> htmlspecialchars($exif_aperture),
							'EXIF_ISO'			=> htmlspecialchars($exif_iso),
							'EXIF_FLASH'		=> htmlspecialchars($exif_flash),
							'EXIF_EXPOSURE_PROG'	=> htmlspecialchars($exif_exposureprogram),
							'EXIF_EXPOSURE_BIAS'	=> htmlspecialchars($exif_exposure_bias),
							'EXIF_METERING_MODE'	=> htmlspecialchars($exif_metering_mode),

							'WHITEB'		=> htmlspecialchars($exif_whitebalance),
							'CAM_MODEL'		=> htmlspecialchars($exif_model),
							'S_EXIF_DATA'	=> true,
						);
					}]]></find>
        <action type="replace-with"><![CDATA[					$exif = ($attachment['extension'] == 'jpg' || $attachment['extension'] == 'jpeg') ? @exif_read_data($filename, 0, true) : array();
					$exif_data = array();
					if (!empty($exif["EXIF"]))
					{
						if(isset($exif["EXIF"]["DateTimeOriginal"]))
						{
							$timestamp_year = substr($exif["EXIF"]["DateTimeOriginal"], 0, 4);
							$timestamp_month = substr($exif["EXIF"]["DateTimeOriginal"], 5, 2);
							$timestamp_day = substr($exif["EXIF"]["DateTimeOriginal"], 8, 2);
							$timestamp_hour = substr($exif["EXIF"]["DateTimeOriginal"], 11, 2);
							$timestamp_minute = substr($exif["EXIF"]["DateTimeOriginal"], 14, 2);
							$timestamp_second = substr($exif["EXIF"]["DateTimeOriginal"], 17, 2);
							$timestamp = mktime($timestamp_hour, $timestamp_minute, $timestamp_second, $timestamp_month, $timestamp_day, $timestamp_year);
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_DATE'], 'EXIF_VALUE' => $user->format_date($timestamp));
						}
						if(isset($exif["EXIF"]["FocalLength"]))
						{
							list($num, $den) = explode("/", $exif["EXIF"]["FocalLength"]);
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_FOCAL'], 'EXIF_VALUE' => sprintf($user->lang['EXIF_FOCAL_EXP'], ($num/$den)));
						}
						if(isset($exif["EXIF"]["ExposureTime"]))
						{
							list($num, $den) = explode("/", $exif["EXIF"]["ExposureTime"]);
							if ($num > $den) { $exif_exposure = $num/$den; } else { $exif_exposure = ' 1/' . $den/$num ; }
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_EXPOSURE'], 'EXIF_VALUE' => sprintf($user->lang['EXIF_EXPOSURE_EXP'], $exif_exposure));
						}
						if(isset($exif["EXIF"]["FNumber"]))
						{
							list($num,$den) = explode("/", $exif["EXIF"]["FNumber"]);
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_APERTURE'], 'EXIF_VALUE' => "F/" . ($num/$den));
						}
						if(isset($exif["EXIF"]["ISOSpeedRatings"]))
						{
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_ISO'], 'EXIF_VALUE' => htmlspecialchars($exif["EXIF"]["ISOSpeedRatings"]));
						}
						if (isset($exif["EXIF"]["WhiteBalance"]))
						{
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_WHITEB'], 'EXIF_VALUE' => $user->lang['EXIF_WHITEB_' . (($exif["EXIF"]["WhiteBalance"]) ? 'MANU' : 'AUTO')]);
						}
						if(isset($exif["EXIF"]["Flash"]))
						{
							if (isset($user->lang['EXIF_FLASH_CASE_' . $exif["EXIF"]["Flash"]]))
							{
								$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_FLASH'], 'EXIF_VALUE' => $user->lang['EXIF_FLASH_CASE_' . $exif["EXIF"]["Flash"]]);
							}
						}
						if (isset($exif["IFD0"]["Model"]))
						{
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_CAM_MODEL'], 'EXIF_VALUE' => htmlspecialchars(ucwords($exif["IFD0"]["Model"])));
						}
						if (isset($exif["EXIF"]["ExposureProgram"]))
						{
							if (isset($user->lang['EXIF_EXPOSURE_PROG_' . $exif["EXIF"]["ExposureProgram"]]))
							{
								$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_EXPOSURE_PROG'], 'EXIF_VALUE' => $user->lang['EXIF_EXPOSURE_PROG_' . $exif["EXIF"]["ExposureProgram"]]);
							}
						}
						if (isset($exif["EXIF"]["ExposureBiasValue"]))
						{
							list($num,$den) = explode("/",$exif["EXIF"]["ExposureBiasValue"]);
							if (($num/$den) == 0) { $exif_exposure_bias = 0; } else { $exif_exposure_bias = $exif["EXIF"]["ExposureBiasValue"]; }
							$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_EXPOSURE_BIAS'], 'EXIF_VALUE' => htmlspecialchars(sprintf($user->lang['EXIF_EXPOSURE_BIAS_EXP'], $exif_exposure_bias)));
						}
						if (isset($exif["EXIF"]["MeteringMode"]))
						{
							if (isset($user->lang['EXIF_METERING_MODE_' . $exif["EXIF"]["MeteringMode"]]))
							{
								$exif_data[] = array('EXIF_NAME' => $user->lang['EXIF_METERING_MODE'], 'EXIF_VALUE' => $user->lang['EXIF_METERING_MODE_' . $exif["EXIF"]["MeteringMode"]]);
							}
						}
						$block_array += array(
							'_exifs'			=> $exif_data,
							'S_HAS_EXIF'		=> (!empty($exif_data)) ? true : false,
						);
					}]]></action>
      </edit>
    </open>
    <open src="styles/prosilver/template/attachment.html">
      <edit>
        <find><![CDATA[			<!-- IF _file.S_EXIF_DATA -->
				<hr />
				<dd><strong>{L_EXIF-DATA}</strong></dd>
				<dd>{L_EXIF_DATE}: <em>{_file.EXIF_DATE}</em></dd>
				<dd>{L_EXIF_FOCAL}: <em>{_file.EXIF_FOCAL} {L_EXIF_FOCAL_EXP}</em></dd>
				<dd>{L_EXIF_EXPOSURE}: <em>{_file.EXIF_EXPOSURE} {L_EXIF_EXPOSURE_EXP}</em></dd>
				<dd>{L_EXIF_APERTURE}: <em>{_file.EXIF_APERTURE}</em></dd>
				<dd>{L_EXIF_EXPOSURE_PROG}: <em>{_file.EXIF_EXPOSURE_PROG}</em></dd>
				<dd>{L_EXIF_EXPOSURE_BIAS}: <em>{_file.EXIF_EXPOSURE_BIAS}</em></dd>
				<dd>{L_EXIF_METERING_MODE}: <em>{_file.EXIF_METERING_MODE}</em></dd>
				<dd>{L_EXIF_ISO}: <em>{_file.EXIF_ISO}</em></dd>
				<dd>{L_EXIF_FLASH}: <em>{_file.EXIF_FLASH}</em></dd>
				<dd>{L_EXIF_WHITEB}: <em>{_file.WHITEB}</em></dd>
				<dd>{L_EXIF_CAM_MODEL}: <em>{_file.CAM_MODEL}</em></dd>
			<!-- ENDIF -->]]></find>
        <action type="replace-with"><![CDATA[			<!-- IF _file.S_HAS_EXIF -->
				<!-- IF _file.COMMENT --><hr /><!-- ENDIF -->
				<dd><strong>{L_EXIF-DATA}</strong></dd>
				<!-- BEGIN _exifs -->
					<dd>{_file._exifs.EXIF_NAME}: <em>{_file._exifs.EXIF_VALUE}</em></dd>
				<!-- END _exifs -->
			<!-- ENDIF -->]]></action>
      </edit>
      <edit>
        <find><![CDATA[			<!-- IF _file.S_EXIF_DATA -->
				<hr />
				<dd><strong>{L_EXIF-DATA}</strong></dd>
				<dd>{L_EXIF_DATE}: <em>{_file.EXIF_DATE}</em></dd>
				<dd>{L_EXIF_FOCAL}: <em>{_file.EXIF_FOCAL} {L_EXIF_FOCAL_EXP}</em></dd>
				<dd>{L_EXIF_EXPOSURE}: <em>{_file.EXIF_EXPOSURE} {L_EXIF_EXPOSURE_EXP}</em></dd>
				<dd>{L_EXIF_APERTURE}: <em>{_file.EXIF_APERTURE}</em></dd>
				<dd>{L_EXIF_EXPOSURE_PROG}: <em>{_file.EXIF_EXPOSURE_PROG}</em></dd>
				<dd>{L_EXIF_EXPOSURE_BIAS}: <em>{_file.EXIF_EXPOSURE_BIAS}</em></dd>
				<dd>{L_EXIF_METERING_MODE}: <em>{_file.EXIF_METERING_MODE}</em></dd>
				<dd>{L_EXIF_ISO}: <em>{_file.EXIF_ISO}</em></dd>
				<dd>{L_EXIF_FLASH}: <em>{_file.EXIF_FLASH}</em></dd>
				<dd>{L_EXIF_WHITEB}: <em>{_file.WHITEB}</em></dd>
				<dd>{L_EXIF_CAM_MODEL}: <em>{_file.CAM_MODEL}</em></dd>
			<!-- ENDIF -->]]></find>
        <action type="replace-with"><![CDATA[			<!-- IF _file.S_HAS_EXIF -->
				<hr />
				<dd><strong>{L_EXIF-DATA}</strong></dd>
				<!-- BEGIN _exifs -->
					<dd>{_file._exifs.EXIF_NAME}: <em>{_file._exifs.EXIF_VALUE}</em></dd>
				<!-- END _exifs -->
			<!-- ENDIF -->]]></action>
      </edit>
    </open>
  </action-group>
</mod>